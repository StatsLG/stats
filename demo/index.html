<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>StatsLG â€” Demos</title>
  <meta name="description" content="Interactive demos created by StatsLG." />
  <link rel="icon" href="/favicon.ico" />

  <!-- Try root-relative CSS first; JS below will fix to relative if needed -->
  <link id="site-css" rel="stylesheet" href="/style/bctcstyle.css">
</head>
<body>
  <div class="layout">
    <!-- Sidebar gets injected here -->
    <aside class="sidebar" aria-label="Site navigation" data-include="/partials/sidebar.html"></aside>

    <main>
      <header class="header">
        <h1>Demos</h1>
        <p class="text-muted">Quick links to interactive classroom demos and prototypes.</p>
      </header>

      <section class="section">
        <div class="row">
          <div>
            <label for="demoSearch">Filter demos</label>
            <input id="demoSearch" type="search" placeholder="Type to filter (e.g., regression, timer, Bengals)" />
          </div>
          <div>
            <label for="demoTag">Tag</label>
            <select id="demoTag">
              <option value="">All</option>
              <option value="stats">Stats</option>
              <option value="visualization">Visualization</option>
              <option value="classroom">Classroom</option>
              <option value="sports">Sports</option>
              <option value="hardware">Hardware</option>
            </select>
          </div>
        </div>
      </section>

      <section class="section">
        <h2>Featured</h2>
        <div class="grid" id="demoGrid">
          <!-- Update the hrefs to match your actual demo files in /demo/ -->
          <article class="card" data-tags="stats visualization classroom">
            <h3>Confidence Interval Visualizer</h3>
            <p>Animated coverage demo with repeated samples and intervals.</p>
            <div class="btns">
              <a class="btn" href="./confidence-intervals.html">Open</a>
              <a class="btn outline" href="./confidence-intervals.html#about">About</a>
            </div>
          </article>

          <article class="card" data-tags="stats visualization classroom">
            <h3>Least Squares Regression Demo</h3>
            <p>Shows how residuals drive the best-fit line.</p>
            <div class="btns">
              <a class="btn" href="./linear-regression.html">Open</a>
              <a class="btn outline" href="./linear-regression.html#about">About</a>
            </div>
          </article>

          <article class="card" data-tags="visualization classroom">
            <h3>Box &amp; Whisker Playground</h3>
            <p>Build and compare box plots; highlight outliers.</p>
            <div class="btns">
              <a class="btn" href="./boxplot.html">Open</a>
              <a class="btn ghost" href="../graphing/">More Graphing</a>
            </div>
          </article>

          <article class="card" data-tags="sports visualization classroom">
            <h3>Bengals LIVE Board</h3>
            <p>Game state, first-down progress, and score animations.</p>
            <div class="btns">
              <a class="btn" href="./bengals-live.html">Open</a>
              <a class="btn outline" href="./bengals-live.html#setup">Setup</a>
            </div>
          </article>

          <article class="card" data-tags="hardware classroom visualization">
            <h3>Visual Timer (Pi / Desktop)</h3>
            <p>Clean countdown with circular and linear modes.</p>
            <div class="btns">
              <a class="btn" href="./visual-timer.html">Open</a>
              <a class="btn outline" href="./visual-timer.html#docs">Docs</a>
            </div>
          </article>

          <article class="card" data-tags="stats classroom">
            <h3>Yahtzee Probability Lab</h3>
            <p>Explore discrete outcomes and exact probabilities.</p>
            <div class="btns">
              <a class="btn" href="./yahtzee-probability.html">Open</a>
              <a class="btn outline" href="./yahtzee-probability.html#guide">Guide</a>
            </div>
          </article>

          <article class="card" data-tags="sports classroom visualization">
            <h3>Reds Scoreboard (Web)</h3>
            <p>Linescore, roster, and fun event animations.</p>
            <div class="btns">
              <a class="btn" href="./reds-scoreboard.html">Open</a>
              <a class="btn outline" href="./reds-scoreboard.html#about">About</a>
            </div>
          </article>

          <article class="card" data-tags="classroom stats">
            <h3>Sampling &amp; CLT Explorer</h3>
            <p>See sampling distributions form as n increases.</p>
            <div class="btns">
              <a class="btn" href="./sampling-lab.html">Open</a>
              <a class="btn outline" href="./sampling-lab.html#about">About</a>
            </div>
          </article>
        </div>
      </section>

      <footer class="site-footer">
        Last updated: <span id="lastUpdated"></span>
      </footer>
    </main>
  </div>

  <!-- Fix paths automatically if we're in a subfolder (e.g., /demo/) -->
  <script>
    (function ensurePathsWorkEverywhere(){
      // If "/style/bctcstyle.css" 404s, swap to "../style/bctcstyle.css"
      const testImg = new Image();
      testImg.onload = testImg.onerror = function(){
        // do nothing; if it loaded, great
      };
      testImg.src = "/style/___pathcheck___"; // harmless ping
      // If we're under a subpath and not at domain root, rewrite includes to ../partials/...
      const inSubdir = location.pathname.split('/').filter(Boolean)[0] !== undefined
                       && location.pathname.split('/').filter(Boolean)[0] !== '';
      if (inSubdir) {
        // Sidebar include path
        document.querySelectorAll('[data-include]').forEach(el=>{
          const url = el.getAttribute('data-include') || '';
          if (url.startsWith('/')) el.setAttribute('data-include', '..' + url);
        });
        // CSS fallback if needed
        const link = document.getElementById('site-css');
        if (link && link.getAttribute('href').startsWith('/')) {
          link.setAttribute('href', '..' + link.getAttribute('href'));
        }
      }
    })();
  </script>

  <!-- Inject /partials/sidebar.html and mark active link -->
  <script>
  (function () {
    async function injectIncludes() {
      const nodes = document.querySelectorAll('[data-include]');
      await Promise.all(Array.from(nodes).map(async (el) => {
        let url = el.getAttribute('data-include');

        // If still root-absolute while on a project path, fix it one more time
        if (!url.startsWith('http') && url.startsWith('/') && location.pathname.split('/').filter(Boolean).length > 0) {
          url = '..' + url;
        }

        const resp = await fetch(url, { cache: 'no-cache' });
        el.innerHTML = await resp.text();

        // Sidebar tweaks: current year + active link highlight
        const yr = el.querySelector('#yr'); if (yr) yr.textContent = new Date().getFullYear();
        const here = location.pathname.replace(/\/index\.html?$/, '/');
        el.querySelectorAll('a[href]').forEach(a => {
          const target = new URL(a.getAttribute('href'), location.origin).pathname
            .replace(/\/index\.html?$/, '/');
          if (here === target || (here.startsWith(target) && target !== '/')) {
            a.classList.add('active');
          }
        });
      }));
    }
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', injectIncludes);
    } else {
      injectIncludes();
    }
  })();
  </script>

  <!-- Filter logic -->
  <script>
    (function(){
      const q = document.getElementById('demoSearch');
      const tag = document.getElementById('demoTag');
      const cards = Array.from(document.querySelectorAll('#demoGrid .card'));
      function applyFilter(){
        const term = (q?.value || '').toLowerCase().trim();
        const t = (tag?.value || '').toLowerCase();
        cards.forEach(card => {
          const hay = (card.textContent || '').toLowerCase();
          const tags = (card.getAttribute('data-tags') || '').toLowerCase();
          const matchTerm = !term || hay.includes(term);
          const matchTag = !t || tags.split(/\s+/).includes(t);
          card.style.display = matchTerm && matchTag ? '' : 'none';
        });
      }
      q?.addEventListener('input', applyFilter);
      tag?.addEventListener('change', applyFilter);
      applyFilter();
      document.getElementById('lastUpdated').textContent =
        new Date(document.lastModified).toLocaleString();
    })();
  </script>
</body>
</html>
