<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>XC Team Scoring Tracker</title>
<style>
  :root{
    --bg:#0f172a; --panel:#0e1626; --panel-2:#0b1220; --muted:#94a3b8; --text:#e5e7eb;
    --ring:rgba(56,189,248,.35);
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{margin:0;background:linear-gradient(180deg,var(--bg),#0b1020);color:var(--text);font:16px/1.4 system-ui,Segoe UI,Roboto,Arial,sans-serif}
  h1{margin:0 0 .5rem}
  .wrap{max-width:1100px;margin:0 auto;padding:18px}
  .row{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
  .grid{display:grid;gap:12px}
  .cols-2{grid-template-columns:1.2fr .8fr}
  @media (max-width:980px){.cols-2{grid-template-columns:1fr}}
  .card{background:linear-gradient(180deg,var(--panel),var(--panel-2));border:1px solid #1f2937;border-radius:14px;box-shadow:0 10px 24px rgba(0,0,0,.25)}
  .card>.hd{padding:12px 14px;border-bottom:1px solid #1f2937;display:flex;align-items:center;gap:10px}
  .card>.bd{padding:14px}
  .btn{appearance:none;border:1px solid #263244;background:#0d1626;color:var(--text);padding:10px 14px;border-radius:12px;cursor:pointer;font-weight:800;transition:.15s box-shadow,.15s transform}
  .btn:hover{box-shadow:0 0 0 3px var(--ring)}
  .btn:active{transform:translateY(1px)}
  .btn.small{padding:6px 10px;border-radius:10px;font-weight:700}
  .btn.ghost{background:transparent}
  label{font-size:.9rem;color:var(--muted)}
  input,select{width:100%;padding:10px 12px;border-radius:10px;border:1px solid #253046;background:#0c1526;color:var(--text)}
  .pill{display:inline-flex;align-items:center;gap:8px;border-radius:999px;padding:6px 10px;border:1px solid #293548;background:#0f1a2a;font-weight:700}
  .pill .dot{width:10px;height:10px;border-radius:50%}
  .teams-area{display:grid;grid-template-columns:repeat(auto-fit,minmax(150px,1fr));gap:10px}
  .team-btn{display:flex;align-items:center;gap:10px;min-height:56px;border:2px solid #2a3446;border-radius:12px;padding:12px;cursor:pointer;font-weight:900;justify-content:center;font-size:1.05rem;text-shadow:0 1px 2px rgba(0,0,0,.6)}
  .team-btn .swatch{width:18px;height:18px;border-radius:50%;border:2px solid rgba(255,255,255,.7)}
  .list{display:flex;flex-direction:column;gap:8px;max-height:360px;overflow:auto;padding-right:6px}
  .chip{display:flex;align-items:center;gap:8px;border:1px solid #263244;background:#0d1626;border-radius:999px;padding:6px 10px}
  .chip .badge{font-size:.75rem;opacity:.9;padding:.1rem .5rem;border-radius:999px;border:1px solid #334155}
  .chip .idx{opacity:.85;font-weight:800;padding:.15rem .55rem;background:#0a1220;border-radius:6px;border:1px solid #273041}
  .chip .move{margin-left:auto;display:flex;gap:6px}
  table{border-collapse:collapse;width:100%}
  th,td{border-bottom:1px solid #1f2937;padding:8px 10px;text-align:left}
  th{color:#c8d4e2;position:sticky;top:0;background:linear-gradient(180deg,#0f172a,#101727);z-index:1}
  .mono{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace}
  .right{text-align:right}
  .subtle{color:var(--muted)}
  .tabbar{display:flex;gap:8px;border-bottom:1px solid #1f2937;margin-top:8px}
  .tab{appearance:none;background:transparent;border:1px solid #273041;border-bottom:none;border-top-left-radius:10px;border-top-right-radius:10px;padding:10px 14px;font-weight:900;cursor:pointer;color:#cbd5e1}
  .tab.active{background:#0f1a2a;color:#e5e7eb}
  .hidden{display:none}
</style>
</head>
<body>
<div class="wrap">
  <div class="row" style="justify-content:space-between">
    <h1>XC Team Scoring Tracker</h1>
    <div class="row">
      <button id="exportBtn" class="btn small ghost" title="Export CSV">Export CSV</button>
      <button id="undoBtn" class="btn small" title="Undo last finisher">Undo</button>
      <button id="resetBtn" class="btn small" title="Clear all data">Reset</button>
    </div>
  </div>

  <div class="tabbar">
    <button class="tab active" data-tab="scoreTab">Scoring</button>
    <button class="tab" data-tab="teamsTab">Teams</button>
  </div>

  <!-- Scoring Tab -->
  <section id="scoreTab">
    <div class="grid cols-2" style="margin-top:10px">
      <section class="card">
        <div class="hd"><strong>Scoring Controls</strong></div>
        <div class="bd grid" style="gap:14px">
          <div class="grid" style="grid-template-columns:1fr 1fr 1fr; gap:12px">
            <div>
              <label>Scoring runners (N)</label>
              <input id="inScoring" type="number" min="3" max="10" value="5" />
            </div>
            <div>
              <label>Displacement per team (D)</label>
              <input id="inDisplace" type="number" min="0" max="5" value="2" />
            </div>
            <div>
              <label>Tie‑breaker</label>
              <select id="tieMode">
                <option value="sixth" selected>Best 6th runner</option>
                <option value="head">Head‑to‑head (#1–#5)</option>
              </select>
            </div>
          </div>
          <div>
            <label>Tap team as each runner finishes</label>
            <div id="teamButtons" class="teams-area" style="margin-top:8px"></div>
          </div>
        </div>
      </section>

      <section class="card">
        <div class="hd row" style="justify-content:space-between">
          <strong>Finishers (live)</strong>
          <span class="subtle">Use ▲ ▼ to adjust order</span>
        </div>
        <div class="bd">
          <div id="finishList" class="list"></div>
        </div>
      </section>

      <section class="card" style="grid-column:1/-1">
        <div class="hd row" style="justify-content:space-between">
          <strong>Team Scores</strong>
          <span class="subtle">Complete teams displace; score = sum of top N adjusted places.</span>
        </div>
        <div class="bd" style="overflow:auto;max-height:420px">
          <table id="scoreTable">
            <thead>
              <tr>
                <th>Rank</th>
                <th>Team</th>
                <th class="right">Score</th>
                <th>Scoring Places</th>
                <th>6th/7th</th>
                <th>H2H (ties)</th>
                <th>Status</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </section>
    </div>
  </section>

  <!-- Teams Tab -->
  <section id="teamsTab" class="hidden">
    <div class="grid" style="margin-top:10px">
      <section class="card">
        <div class="hd"><strong>Teams Setup</strong></div>
        <div class="bd">
          <div class="grid" style="grid-template-columns: 1fr 160px; gap:10px">
            <input id="teamName" placeholder="New team name (e.g., Tigers)" />
            <input id="teamColor" type="color" value="#ff6600" title="Team color" />
          </div>
          <div class="row" style="margin-top:8px">
            <button id="addTeam" class="btn small">Add Team</button>
            <button id="rmAllTeams" class="btn small ghost">Remove All</button>
            <button id="quickSeed" class="btn small ghost" title="Adds a few sample teams">Seed Samples</button>
          </div>
          <div class="sep" style="height:1px;background:#1f2937;margin:10px 0"></div>
          <div class="row" id="teamsAdmin"></div>
        </div>
      </section>
    </div>
  </section>
</div>

<script>
(function(){
  'use strict';
  // ---------- State ----------
  var state = { N:5, D:2, tieMode:'sixth', nextTeamId:1, teams:[], finishes:[] };

  // ---------- Helpers ----------
  function $(id){ return document.getElementById(id); }
  function bestTextColor(hex){
    if(!hex){ return '#ffffff'; }
    var h = String(hex).replace('#','');
    if(h.length<6){ return '#ffffff'; }
    var r = parseInt(h.substr(0,2),16), g = parseInt(h.substr(2,2),16), b = parseInt(h.substr(4,2),16);
    var yiq = (r*299 + g*587 + b*114)/1000; return yiq >= 140 ? '#0b1220' : '#f8fafc';
  }
  function clamp(v,min,max){ v=parseInt(v,10); if(isNaN(v)) v=min; return Math.max(min, Math.min(max, v)); }
  function el(tag, attrs){
    var node = document.createElement(tag);
    attrs = attrs||{};
    for(var k in attrs){
      if(!attrs.hasOwnProperty(k)) continue;
      if(k==='text'){ node.textContent = attrs[k]; }
      else if(k==='class'){ node.className = attrs[k]; }
      else if(k==='style'){ node.setAttribute('style', attrs[k]); }
      else { node.setAttribute(k, attrs[k]); }
    }
    for(var i=2;i<arguments.length;i++){ var c = arguments[i]; if(c!=null) node.appendChild(c); }
    return node;
  }

  // ---------- Tabs ----------
  function switchTab(tabId){
    var tabs = document.querySelectorAll('.tab');
    for(var i=0;i<tabs.length;i++){ var b=tabs[i]; b.classList.toggle('active', b.getAttribute('data-tab')===tabId); }
    var sections = document.querySelectorAll('section[id$="Tab"]');
    for(var j=0;j<sections.length;j++){ sections[j].classList.add('hidden'); }
    var target = $(tabId); if(target){ target.classList.remove('hidden'); }
  }

  // ---------- Teams ----------
  function addTeam(name, color){
    name = (name||'').trim(); if(!name){ alert('Enter a team name'); return; }
    var t = { id: state.nextTeamId++, name:name, color:color||'#888888' };
    state.teams.push(t); renderTeamsBar(); renderTeamsAdmin();
  }
  function removeTeam(id){
    var nf=[]; for(var i=0;i<state.finishes.length;i++){ if(state.finishes[i].teamId!==id) nf.push(state.finishes[i]); }
    state.finishes = nf;
    var nt=[]; for(var j=0;j<state.teams.length;j++){ if(state.teams[j].id!==id) nt.push(state.teams[j]); }
    state.teams = nt; renderAll();
  }
  function clearTeams(){ state.teams=[]; state.finishes=[]; renderAll(); }

  // ---------- Scoring Logic ----------
  function calculate(){
    var N = state.N, D = state.D;
    var rawCounts = {}; for(var i=0;i<state.teams.length;i++){ rawCounts[state.teams[i].id]=0; }
    for(var r=0;r<state.finishes.length;r++){ var f=state.finishes[r]; rawCounts[f.teamId]=(rawCounts[f.teamId]||0)+1; }
    function eligible(teamId){ return (rawCounts[teamId]||0) >= N; }

    var within = {}, adjusted=[], roles=[]; // roles by raw index
    for(var idx=0; idx<state.finishes.length; idx++){
      var fin = state.finishes[idx], tid = fin.teamId; within[tid]=(within[tid]||0)+1; var k = within[tid];
      if(!eligible(tid)){ roles[idx]='no-displace (incomplete team)'; continue; }
      if(k<=N){ adjusted.push({rawIndex:idx, teamId:tid, role:'scorer'}); roles[idx]='scorer'; }
      else if(k<=N+D){ adjusted.push({rawIndex:idx, teamId:tid, role:'displacer'}); roles[idx]='displacer'; }
      else { roles[idx]='non-displacing (>N+D)'; }
    }

    var teamAdj={}; for(var a=0;a<adjusted.length;a++){ var ap=a+1, t=adjusted[a].teamId; if(!teamAdj[t]) teamAdj[t]=[]; teamAdj[t].push(ap); }

    var rows=[];
    for(var ti=0; ti<state.teams.length; ti++){
      var team = state.teams[ti]; var adjArr = teamAdj[team.id]||[]; var count=rawCounts[team.id]||0; var incomplete = count<N;
      var scoringPlaces = adjArr.slice(0,N); var score=null; if(!incomplete && scoringPlaces.length===N){ score=0; for(var s=0;s<scoringPlaces.length;s++){ score+=scoringPlaces[s]; } }
      var tieBreakers = adjArr.slice(N, N+3);
      rows.push({ teamId:team.id, score:score, scoringPlaces:scoringPlaces, tieBreakers:tieBreakers, incomplete:incomplete, count:count });
    }

    var complete=[]; for(var x=0;x<rows.length;x++){ if(!rows[x].incomplete && rows[x].score!==null) complete.push(rows[x]); }
    complete.sort(function(a,b){
      if(a.score!==b.score) return a.score-b.score;
      if(state.tieMode==='head'){
        for(var i2=0;i2<N;i2++){ var av = (i2<a.scoringPlaces.length)?a.scoringPlaces[i2]:Infinity; var bv = (i2<b.scoringPlaces.length)?b.scoringPlaces[i2]:Infinity; if(av!==bv) return av-bv; }
      }
      var len=Math.max(a.tieBreakers.length,b.tieBreakers.length); for(var j2=0;j2<len;j2++){ var tav=(j2<a.tieBreakers.length)?a.tieBreakers[j2]:Infinity; var tbv=(j2<b.tieBreakers.length)?b.tieBreakers[j2]:Infinity; if(tav!==tbv) return tav-tbv; }
      return 0;
    });

    var ranked={}, finalRows=complete.slice(); for(var y=0;y<complete.length;y++){ ranked[complete[y].teamId]=true; }
    for(var z=0; z<rows.length; z++){ if(!ranked[rows[z].teamId]) finalRows.push(rows[z]); }

    return { adjusted:adjusted, roles:roles, rows:finalRows };
  }

  function h2hScore(aPlaces, bPlaces, N){ var aW=0,bW=0; for(var i=0;i<N;i++){ var av=(i<aPlaces.length)?aPlaces[i]:Infinity; var bv=(i<bPlaces.length)?bPlaces[i]:Infinity; if(av<bv) aW++; else if(bv<av) bW++; } return aW+"-"+bW; }

  // ---------- Renderers ----------
  function renderTeamsBar(){
    var root = $('teamButtons'); if(!root) return; root.innerHTML='';
    for(var i=0;i<state.teams.length;i++){
      (function(t){
        var btn = el('button',{class:'team-btn'});
        btn.style.borderColor = t.color||'#446';
        btn.style.background = 'transparent';
        btn.style.color = bestTextColor(t.color||'#446');
        btn.appendChild(el('span',{class:'swatch', style:'background:'+t.color}));
        btn.appendChild(el('span',{text:t.name}));
        btn.addEventListener('click', function(){ state.finishes.push({teamId:t.id}); renderAll(); });
        root.appendChild(btn);
      })(state.teams[i]);
    }
  }

  function renderTeamsAdmin(){
    var admin=$('teamsAdmin'); if(!admin) return; admin.innerHTML='';
    for(var i=0;i<state.teams.length;i++){
      (function(t){
        var wrap = el('div',{class:'pill'}); wrap.style.gap='6px';
        wrap.appendChild(el('span',{class:'dot', style:'background:'+t.color}));
        var color = el('input',{type:'color', value:t.color});
        var name = el('input',{value:t.name});
        var del = el('button',{class:'btn small', text:'❌', title:'Remove'});
        color.addEventListener('input', function(){ t.color=color.value; renderTeamsBar(); renderAll(); });
        name.addEventListener('change', function(){ t.name=name.value.trim()||t.name; renderTeamsBar(); renderAll(); });
        del.addEventListener('click', function(){ removeTeam(t.id); });
        wrap.appendChild(color); wrap.appendChild(name); wrap.appendChild(del);
        admin.appendChild(wrap);
      })(state.teams[i]);
    }
  }

  function renderFinishList(calc){
    var list=$('finishList'); if(!list) return; list.innerHTML='';
    var roleByIndex={}; for(var i=0;i<calc.adjusted.length;i++){ var it=calc.adjusted[i]; roleByIndex[it.rawIndex]={adjPlace:i+1, role:it.role}; }

    for(var idx=0; idx<state.finishes.length; idx++){
      (function(rawIdx){
        var f = state.finishes[rawIdx]; var team=null; for(var t=0;t<state.teams.length;t++){ if(state.teams[t].id===f.teamId){ team=state.teams[t]; break; } }
        var info = roleByIndex[rawIdx]; var adj = info?info.adjPlace:'…'; var role=info?info.role:'pending';
        var row = el('div',{class:'chip'});
        row.appendChild(el('span',{class:'idx', text:String(rawIdx+1)}));
        var pill = el('span',{class:'pill'});
        pill.appendChild(el('span',{class:'dot', style:'background:'+(team?team.color:'#64748b')}));
        pill.appendChild(el('span',{text: team?team.name:'Unknown'}));
        row.appendChild(pill);
        row.appendChild(el('span',{class:'badge', text:role}));
        row.appendChild(el('span',{class:'badge', text:'adj: '+adj}));
        var move = el('span',{class:'move'});
        var up = el('button',{class:'btn small', text:'▲', title:'Move up'});
        var down = el('button',{class:'btn small', text:'▼', title:'Move down'});
        up.addEventListener('click', function(){ moveFinish(rawIdx,-1); });
        down.addEventListener('click', function(){ moveFinish(rawIdx,1); });
        move.appendChild(up); move.appendChild(down); row.appendChild(move);
        list.appendChild(row);
      })(idx);
    }
  }

  function renderScores(calc){
    var st=$('scoreTable'); if(!st) return; var tbody=st.getElementsByTagName('tbody')[0]; tbody.innerHTML='';
    if(calc.rows.length===0){ var tr0=el('tr'); var td0=el('td',{text:'No team scores yet. Add finishers to begin.'}); td0.colSpan=7; td0.className='subtle'; tr0.appendChild(td0); tbody.appendChild(tr0); return; }

    // Build score -> indices group for ties among complete teams
    var scoreGroups={};
    for(var i=0;i<calc.rows.length;i++){
      var rr=calc.rows[i];
      if(!rr.incomplete && rr.score!==null){
        var key=String(rr.score);
        if(!scoreGroups[key]) scoreGroups[key]=[];
        scoreGroups[key].push(i);
      } else { break; }
    }

    function groupHasTie(score){ var g=scoreGroups[String(score)]||[]; return g.length>1; }

    for(var r=0;r<calc.rows.length;r++){
      var rowData=calc.rows[r]; var team=null; for(var k=0;k<state.teams.length;k++){ if(state.teams[k].id===rowData.teamId){ team=state.teams[k]; break; } }
      var tr=el('tr');
      tr.appendChild(el('td',{text: rowData.incomplete?'—': String(r+1)}));
      var teamCell=el('td'); var pill=el('span',{class:'pill'}); pill.appendChild(el('span',{class:'dot', style:'background:'+(team?team.color:'#64748b')})); pill.appendChild(el('span',{text: team?team.name:'Unknown'})); teamCell.appendChild(pill); tr.appendChild(teamCell);
      tr.appendChild(el('td',{class:'right mono', text: rowData.score===null?'—': String(rowData.score)}));
      tr.appendChild(el('td',{class:'mono', text: rowData.scoringPlaces.length? rowData.scoringPlaces.join(', '): '—'}));
      var sixth = rowData.tieBreakers[0]; var seventh = rowData.tieBreakers[1];
      tr.appendChild(el('td',{class:'mono', text: (sixth?String(sixth):'—') + (seventh?(', '+String(seventh)):'')}));
      var h2h='—';
      if(!rowData.incomplete && rowData.score!==null && groupHasTie(rowData.score)){
        var group = scoreGroups[String(rowData.score)]; var pos = group.indexOf(r);
        var oppIndex = -1; if(pos>0) oppIndex = group[pos-1]; else if(pos===0 && group.length>1) oppIndex = group[1];
        if(oppIndex!==-1){ var opp=calc.rows[oppIndex]; h2h = h2hScore(rowData.scoringPlaces, opp.scoringPlaces, state.N); }
      }
      tr.appendChild(el('td',{class:'mono', text: h2h}));
      var status=rowData.incomplete?('Incomplete ('+rowData.count+'/'+state.N+')'):'Complete'; tr.appendChild(el('td',{text:status}));
      tbody.appendChild(tr);
    }
  }

  function renderAll(){
    $('inScoring').value=state.N; $('inDisplace').value=state.D; $('tieMode').value=state.tieMode;
    var calc=calculate(); renderTeamsBar(); renderTeamsAdmin(); renderFinishList(calc); renderScores(calc);
  }

  // ---------- Mutations ----------
  function moveFinish(idx, delta){ var j=idx+delta; if(j<0||j>=state.finishes.length) return; var tmp=state.finishes[idx]; state.finishes[idx]=state.finishes[j]; state.finishes[j]=tmp; renderAll(); }

  // ---------- Export ----------
  function exportCsv(){
    var calc=calculate(); var lines=[]; lines.push('XC Team Scoring Export'); lines.push('Scoring N,'+state.N); lines.push('Displacement D,'+state.D); lines.push('Tie Mode,'+state.tieMode); lines.push('');
    lines.push('Finish List'); lines.push('Raw Place,Team,Adjusted Place,Role');
    var mapAdj={}; for(var i=0;i<calc.adjusted.length;i++){ mapAdj[calc.adjusted[i].rawIndex]=i+1; }
    for(var r=0;r<state.finishes.length;r++){ var fin=state.finishes[r]; var team=null; for(var t=0;t<state.teams.length;t++){ if(state.teams[t].id===fin.teamId){ team=state.teams[t]; break; } } var adj=(mapAdj[r]||''); var role='pending'; for(var a=0;a<calc.adjusted.length;a++){ if(calc.adjusted[a].rawIndex===r){ role=calc.adjusted[a].role; break; } } lines.push([r+1, team?team.name:'', adj, role].join(',')); }
    lines.push(''); lines.push('Team Scores'); lines.push('Rank,Team,Score,Scoring Places,6th/7th,H2H (ties),Status');
    for(var i2=0;i2<calc.rows.length;i2++){ var rd=calc.rows[i2]; var team2=null; for(var u=0;u<state.teams.length;u++){ if(state.teams[u].id===rd.teamId){ team2=state.teams[u]; break; } } var rank=rd.incomplete?'':(i2+1); var places=rd.scoringPlaces.length?rd.scoringPlaces.join(' '):''; var sixth=rd.tieBreakers[0]; var seventh=rd.tieBreakers[1]; var tbOut=((sixth?String(sixth):'')+(seventh?(' '+String(seventh)):'')).trim(); var h2h=''; // only for ties
      // build tie group quickly
      var scoreGroupsCsv={}; for(var gi=0;gi<calc.rows.length;gi++){ var rr=calc.rows[gi]; if(!rr.incomplete && rr.score!==null){ var key=String(rr.score); if(!scoreGroupsCsv[key]) scoreGroupsCsv[key]=[]; scoreGroupsCsv[key].push(gi);} else break; }
      var group=scoreGroupsCsv[String(rd.score)]||[]; if(group.length>1){ var pos=group.indexOf(i2); var oppIndex=(pos>0)?group[pos-1]: (group.length>1?group[1]:-1); if(oppIndex!==-1){ h2h=h2hScore(rd.scoringPlaces, calc.rows[oppIndex].scoringPlaces, state.N); } }
      var status=rd.incomplete?('Incomplete ('+rd.count+'/'+state.N+')'):'Complete'; var scoreOut=(rd.score===null?'':rd.score); lines.push([rank, team2?team2.name:'', scoreOut, places, tbOut, h2h, status].join(',')); }
    var blob=new Blob([lines.join('\n')],{type:'text/csv'}); var url=URL.createObjectURL(blob); var a=document.createElement('a'); a.href=url; a.download='xc_scoring_export.csv'; document.body.appendChild(a); a.click(); setTimeout(function(){URL.revokeObjectURL(url); a.remove();},400);
  }

  // ---------- Wireup ----------
  window.addEventListener('DOMContentLoaded', function(){
    var tabs=document.querySelectorAll('.tab'); for(var i=0;i<tabs.length;i++){ (function(btn){ btn.addEventListener('click', function(){ switchTab(btn.getAttribute('data-tab')); }); })(tabs[i]); }
    $('inScoring').addEventListener('change', function(e){ state.N=clamp(e.target.value,1,10); e.target.value=state.N; renderAll(); });
    $('inDisplace').addEventListener('change', function(e){ state.D=clamp(e.target.value,0,10); e.target.value=state.D; renderAll(); });
    $('tieMode').addEventListener('change', function(e){ state.tieMode = e.target.value==='head' ? 'head' : 'sixth'; renderAll(); });
    $('exportBtn').addEventListener('click', exportCsv);
    $('undoBtn').addEventListener('click', function(){ state.finishes.pop(); renderAll(); });
    $('resetBtn').addEventListener('click', function(){ if(confirm('Clear all finishers and scores?')){ state.finishes=[]; renderAll(); }});
    $('addTeam').addEventListener('click', function(){ addTeam($('teamName').value, $('teamColor').value); $('teamName').value=''; });
    $('rmAllTeams').addEventListener('click', function(){ if(confirm('Remove all teams and finishes?')) clearTeams(); });
    $('quickSeed').addEventListener('click', function(){ addTeam('Tigers','#ff6600'); addTeam('Reds','#c6011f'); addTeam('Bulldogs','#3b82f6'); addTeam('Eagles','#22c55e'); });
    renderAll();
  });
})();
</script>
</body>
</html>